model Branch {
  id          String                 @id @default(cuid())
  name        String
  contactEmail String
  phoneNumber String?
  address     String?
  website     String?

  // Relationship to the normal weekly operating hours
  operatingHours BranchOperatingHours[]
  
  // Relationship to special closures or holidays
  specialClosures BranchSpecialClosure[]

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  staff       Staff[]
  services    Service[]
}



model BranchOperatingHours {
  id        String @id @default(cuid())
  name      String // monday, tuesday, ...
  dayOfWeek Int // @see getDay() documentation, 0 for Sunday, 1 for Monday, ...
  openTime  String
  closeTime String

  branchId    String
  branch      Branch   @relation(fields: [branchId], references: [id], onDelete: Cascade)

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@unique([branchId, dayOfWeek])
}

model BranchSpecialClosure {
  id          String   @id @default(cuid())
  branchId    String
  date        DateTime
  closeReason String?

  branch      Branch   @relation(fields: [branchId], references: [id], onDelete: Cascade)

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@unique([branchId, date])  // Ensures no duplicate closure date for the same branch
}

model Staff {
  id            String         @id @default(cuid())
  userId        String         @unique
  branchId      String
  user          User           @relation(fields: [userId], references: [id])
  branch        Branch         @relation(fields: [branchId], references: [id])
  role          String
  aboutMe       String?
  profileImage  String?
  
  // New relation field:
  staffServices StaffService[]

  @@unique([userId, branchId])
}

model StaffService {
  staffId   String
  serviceId String

  staff     Staff   @relation(fields: [staffId], references: [id], onDelete: Cascade)
  service   Service @relation(fields: [serviceId], references: [id], onDelete: Cascade)

  @@id([staffId, serviceId])
}


